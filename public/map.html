<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="apple-touch-icon" sizes="76x76" href="public/assets-dashboard/img/apple-icon.png" />
		<link rel="icon" type="image/png" href="public/assets-dashboard/img/favicon.png" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<title>
			Crime Alert System Dashboard
		</title>
		<meta
			content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no"
			name="viewport"
		/>
		<!--     Fonts and icons     -->
		<link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
		<link
			rel="stylesheet"
			href="https://use.fontawesome.com/releases/v5.7.1/css/all.css"
			integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr"
			crossorigin="anonymous"
		/>
		<!-- CSS Files -->
		<link href="public/assets-dashboard/css/bootstrap.min.css" rel="stylesheet" />
		<link href="public/assets-dashboard/css/now-ui-dashboard.css?v=1.3.0" rel="stylesheet" />
		<!-- CSS Just for demo purpose, don't include it in your project -->
		<link href="public/assets-dashboard/demo/demo.css" rel="stylesheet" />

		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.5.1/dist/leaflet.css" />
	</head>

	<body class="">
		<div class="wrapper ">
			<div class="sidebar" data-color="blue">
				<!--
        Tip 1: You can change the color of the sidebar using: data-color="blue | green | orange | red | yellow"
    -->
				<div class="sidebar-wrapper" id="sidebar-wrapper">
					<ul class="nav">
						<li class="active ">
							<a href="/dashboard">
								<i class="now-ui-icons design_app"></i>
								<p>Dashboard</p>
							</a>
						</li>
						<li>
							<a href="/map">
								<i class="now-ui-icons location_map-big"></i>
								<p>Heat Maps</p>
							</a>
						</li>
						<li>
							<a href="/cases">
								<i class="now-ui-icons design_bullet-list-67"></i>
								<p>Reported Cases</p>
							</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="main-panel" id="main-panel">
				<!-- Navbar -->
				<nav class="navbar navbar-expand-lg navbar-transparent  bg-primary  navbar-absolute">
					<div class="container-fluid">
						<div class="navbar-wrapper">
							<div class="navbar-toggle">
								<button type="button" class="navbar-toggler">
									<span class="navbar-toggler-bar bar1"></span>
									<span class="navbar-toggler-bar bar2"></span>
									<span class="navbar-toggler-bar bar3"></span>
								</button>
							</div>
							<a class="navbar-brand" href="#pablo">Heat Maps</a>
						</div>
						<button
							class="navbar-toggler"
							type="button"
							data-toggle="collapse"
							data-target="#navigation"
							aria-controls="navigation-index"
							aria-expanded="false"
							aria-label="Toggle navigation"
						>
							<span class="navbar-toggler-bar navbar-kebab"></span>
							<span class="navbar-toggler-bar navbar-kebab"></span>
							<span class="navbar-toggler-bar navbar-kebab"></span>
						</button>
					</div>
				</nav>
				<!-- End Navbar -->
				<div class="panel-header panel-header-sm"></div>
				<div class="content">
					<div class="row">
						<div class="col-md-12">
							<div class="card ">
								<div class="card-header ">
									Heat Maps Based On Reported Cases
									<br /><br />
									<div class="">
										<i class="fa fa-circle text-success"></i><small> Theft</small>
										<i class="fa fa-circle text-primary"></i><small> DUI</small>
										<i class="fa fa-circle text-info"></i><small> Assault</small>
										<i class="fa fa-circle text-danger"></i><small> Battery</small>
										<i class="fa fa-circle "></i><small> Rape</small>
										<i class="fa fa-circle text-danger"></i><small> Hit and Run</small>
										<i class="fa fa-circle text-danger"></i><small> Robbery</small>
										<i class="fa fa-circle text-info"></i><small> Arson</small>
										<i class="fa fa-circle text-danger"></i><small> Burglary</small>
									</div>
								</div>
								<div class="card-body ">
									<div id="map" class="map"></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<!--   Core JS Files   -->
		<script src="public/assets-dashboard/js/core/jquery.min.js"></script>
		<script src="public/assets-dashboard/js/core/popper.min.js"></script>
		<script src="public/assets-dashboard/js/core/bootstrap.min.js"></script>
		<script src="public/assets-dashboard/js/plugins/perfect-scrollbar.jquery.min.js"></script>
		<!-- Chart JS -->
		<script src="public/assets-dashboard/js/plugins/chartjs.min.js"></script>
		<!--  Notifications Plugin    -->
		<script src="public/assets-dashboard/js/plugins/bootstrap-notify.js"></script>
		<!-- Control Center for Now Ui Dashboard: parallax effects, scripts for the example pages etc -->
		<script
			src="public/assets-dashboard/js/now-ui-dashboard.min.js?v=1.3.0"
			type="text/javascript"
		></script>
		<!-- Now Ui Dashboard DEMO methods, don't include it in your project! -->
		<script src="public/assets-dashboard/demo/demo.js"></script>
		<script src="https://unpkg.com/leaflet@1.5.1/dist/leaflet.js"></script>
		<script>
			var map = L.map('map');
			var target = L.latLng(-17.83, 31.0012);
			map.setView(target, 13);

			L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				attribution:
					'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
			}).addTo(map);
		</script>
		<script>
			fetch('http://127.0.0.1:3000/getCases', {
				method: 'GET'
			})
				.then(res => res.json())
				.then(res => {
					console.log(res);
					res.cases.map((value, i) => {
						let color;
						console.log(value);
						switch (value.type) {
							case 'rape':
								color = 'black';
								break;
							default:
								color = 'red';
						}
						L.circle([value.location.latitude, value.location.longitude], {
							radius: 200,
							fillColor: color,
							color: color
						})
							.addTo(map)
							.bindTooltip(value.type)
							.openTooltip();
					});
				})
				.catch(error => console.log(error));
		</script>
	</body>
</html>
